# Generated by Django 4.2 on 2025-12-14 19:27

from decimal import Decimal
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('api', '0005_alter_pesticideproduct_options_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='Buyer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('buyer_type', models.CharField(choices=[('packing_house', 'Packing House'), ('processor', 'Processor'), ('direct_sale', 'Direct Sale'), ('farmers_market', 'Farmers Market'), ('distributor', 'Distributor'), ('export', 'Export')], default='packing_house', max_length=20)),
                ('contact_name', models.CharField(blank=True, max_length=200)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('address', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state', models.CharField(default='CA', max_length=2)),
                ('zip_code', models.CharField(blank=True, max_length=10)),
                ('license_number', models.CharField(blank=True, help_text='Packer/shipper license number if applicable', max_length=50)),
                ('payment_terms', models.CharField(blank=True, help_text='e.g., Net 30, COD, etc.', max_length=100)),
                ('active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name_plural': 'Buyers',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Harvest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('harvest_date', models.DateField()),
                ('harvest_number', models.PositiveIntegerField(default=1, help_text='Pick number this season (1st, 2nd, 3rd pick)')),
                ('crop_variety', models.CharField(choices=[('navel_orange', 'Navel Orange'), ('valencia_orange', 'Valencia Orange'), ('cara_cara', 'Cara Cara Orange'), ('blood_orange', 'Blood Orange'), ('meyer_lemon', 'Meyer Lemon'), ('eureka_lemon', 'Eureka Lemon'), ('lisbon_lemon', 'Lisbon Lemon'), ('lime', 'Lime'), ('grapefruit_white', 'White Grapefruit'), ('grapefruit_ruby', 'Ruby Red Grapefruit'), ('mandarin', 'Mandarin'), ('tangerine', 'Tangerine'), ('clementine', 'Clementine'), ('satsuma', 'Satsuma'), ('tangelo', 'Tangelo'), ('kumquat', 'Kumquat'), ('other', 'Other')], default='navel_orange', max_length=30)),
                ('acres_harvested', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))])),
                ('total_bins', models.PositiveIntegerField(default=0)),
                ('bin_weight_lbs', models.PositiveIntegerField(default=900, help_text='Weight per bin in pounds')),
                ('estimated_weight_lbs', models.DecimalField(blank=True, decimal_places=2, help_text='Auto-calculated from bins × bin_weight', max_digits=12, null=True)),
                ('phi_verified', models.BooleanField(default=False, help_text='User confirms PHI compliance check performed')),
                ('last_application_date', models.DateField(blank=True, help_text='Auto-populated from most recent application', null=True)),
                ('last_application_product', models.CharField(blank=True, help_text='Auto-populated', max_length=200)),
                ('days_since_last_application', models.PositiveIntegerField(blank=True, help_text='Auto-calculated', null=True)),
                ('phi_required_days', models.PositiveIntegerField(blank=True, help_text='PHI from product label', null=True)),
                ('phi_compliant', models.BooleanField(blank=True, help_text='Auto-calculated: days_since >= phi_required', null=True)),
                ('lot_number', models.CharField(blank=True, help_text='Auto-generated if blank', max_length=50, unique=True)),
                ('field_conditions', models.TextField(blank=True, help_text='Weather, ground conditions, etc.')),
                ('equipment_cleaned', models.BooleanField(default=False, help_text='Harvest equipment sanitation verified')),
                ('no_contamination_observed', models.BooleanField(default=False, help_text='No glass, metal, animal intrusion observed')),
                ('supervisor_name', models.CharField(blank=True, max_length=200)),
                ('status', models.CharField(choices=[('in_progress', 'In Progress'), ('complete', 'Complete'), ('verified', 'Verified')], default='in_progress', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('field', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='harvests', to='api.field')),
            ],
            options={
                'verbose_name_plural': 'Harvests',
                'ordering': ['-harvest_date', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='LaborContractor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=200)),
                ('contact_name', models.CharField(blank=True, max_length=200)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('address', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state', models.CharField(default='CA', max_length=2)),
                ('zip_code', models.CharField(blank=True, max_length=10)),
                ('contractor_license', models.CharField(blank=True, help_text='Farm Labor Contractor License Number', max_length=50)),
                ('license_expiration', models.DateField(blank=True, null=True)),
                ('insurance_carrier', models.CharField(blank=True, max_length=200)),
                ('insurance_policy_number', models.CharField(blank=True, max_length=100)),
                ('insurance_expiration', models.DateField(blank=True, null=True)),
                ('workers_comp_carrier', models.CharField(blank=True, max_length=200)),
                ('workers_comp_policy', models.CharField(blank=True, max_length=100)),
                ('workers_comp_expiration', models.DateField(blank=True, null=True)),
                ('food_safety_training_current', models.BooleanField(default=False, help_text='Crew has current food safety training')),
                ('training_expiration', models.DateField(blank=True, null=True)),
                ('default_hourly_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=8, null=True)),
                ('default_piece_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Rate per bin', max_digits=8, null=True)),
                ('active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Labor Contractor',
                'verbose_name_plural': 'Labor Contractors',
                'ordering': ['company_name'],
            },
        ),
        migrations.CreateModel(
            name='HarvestLoad',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('load_number', models.PositiveIntegerField(default=1, help_text='Load number within this harvest')),
                ('bins', models.PositiveIntegerField(default=0)),
                ('weight_lbs', models.DecimalField(blank=True, decimal_places=2, help_text='Scale weight', max_digits=12, null=True)),
                ('weight_ticket_number', models.CharField(blank=True, help_text='Scale ticket reference', max_length=50)),
                ('destination_address', models.CharField(blank=True, help_text='Override buyer address if different', max_length=255)),
                ('grade', models.CharField(choices=[('fancy', 'Fancy'), ('choice', 'Choice'), ('standard', 'Standard'), ('juice', 'Juice Grade'), ('reject', 'Reject/Cull')], default='choice', max_length=20)),
                ('size_grade', models.CharField(blank=True, choices=[('48', '48'), ('56', '56'), ('72', '72'), ('88', '88'), ('113', '113'), ('138', '138'), ('163', '163'), ('180', '180'), ('200', '200'), ('235', '235'), ('mixed', 'Mixed')], max_length=10)),
                ('quality_notes', models.TextField(blank=True, help_text='Brix, color, defects, etc.')),
                ('price_per_unit', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('price_unit', models.CharField(choices=[('per_bin', 'Per Bin'), ('per_lb', 'Per Pound'), ('per_ton', 'Per Ton'), ('per_box', 'Per Box'), ('per_carton', 'Per Carton'), ('flat_rate', 'Flat Rate')], default='per_bin', max_length=20)),
                ('total_revenue', models.DecimalField(blank=True, decimal_places=2, help_text='Auto-calculated or manual override', max_digits=12, null=True)),
                ('payment_status', models.CharField(choices=[('pending', 'Pending'), ('invoiced', 'Invoiced'), ('partial', 'Partially Paid'), ('paid', 'Paid'), ('disputed', 'Disputed')], default='pending', max_length=20)),
                ('payment_date', models.DateField(blank=True, null=True)),
                ('invoice_number', models.CharField(blank=True, max_length=50)),
                ('truck_id', models.CharField(blank=True, help_text='License plate or truck number', max_length=50)),
                ('trailer_id', models.CharField(blank=True, max_length=50)),
                ('driver_name', models.CharField(blank=True, max_length=200)),
                ('departure_time', models.DateTimeField(blank=True, null=True)),
                ('arrival_time', models.DateTimeField(blank=True, null=True)),
                ('temperature_at_loading', models.DecimalField(blank=True, decimal_places=1, help_text='°F at time of loading', max_digits=5, null=True)),
                ('seal_number', models.CharField(blank=True, help_text='Trailer seal number if applicable', max_length=50)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('buyer', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='loads', to='api.buyer')),
                ('harvest', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='loads', to='api.harvest')),
            ],
            options={
                'verbose_name': 'Harvest Load',
                'verbose_name_plural': 'Harvest Loads',
                'ordering': ['harvest', 'load_number'],
            },
        ),
        migrations.CreateModel(
            name='HarvestLabor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('crew_name', models.CharField(blank=True, help_text='Crew identifier or name', max_length=200)),
                ('foreman_name', models.CharField(blank=True, max_length=200)),
                ('worker_count', models.PositiveIntegerField(default=1)),
                ('start_time', models.DateTimeField(blank=True, null=True)),
                ('end_time', models.DateTimeField(blank=True, null=True)),
                ('total_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Auto-calculated or manual entry', max_digits=8, null=True)),
                ('pay_type', models.CharField(choices=[('hourly', 'Hourly'), ('piece_rate', 'Piece Rate (per bin)'), ('contract', 'Contract/Flat Rate')], default='piece_rate', max_length=20)),
                ('rate', models.DecimalField(blank=True, decimal_places=2, help_text='$/hour or $/bin depending on pay_type', max_digits=10, null=True)),
                ('bins_picked', models.PositiveIntegerField(blank=True, help_text='For piece rate calculation', null=True)),
                ('total_labor_cost', models.DecimalField(blank=True, decimal_places=2, help_text='Auto-calculated or manual entry', max_digits=12, null=True)),
                ('training_verified', models.BooleanField(default=False, help_text='Workers have current food safety training')),
                ('hygiene_facilities_available', models.BooleanField(default=False, help_text='Handwashing stations and toilets available')),
                ('illness_check_performed', models.BooleanField(default=False, help_text='Workers checked for illness/symptoms')),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('contractor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='harvest_jobs', to='api.laborcontractor')),
                ('harvest', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='labor_records', to='api.harvest')),
            ],
            options={
                'verbose_name': 'Harvest Labor Record',
                'verbose_name_plural': 'Harvest Labor Records',
                'ordering': ['harvest', '-start_time'],
            },
        ),
    ]
