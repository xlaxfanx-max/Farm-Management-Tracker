# Generated by Django 4.2 on 2026-01-17 13:39

from django.db import migrations


def seed_crops_and_rootstocks(apps, schema_editor):
    """Seed default crops and rootstocks for California citrus and avocado production."""
    Crop = apps.get_model('api', 'Crop')
    Rootstock = apps.get_model('api', 'Rootstock')

    # ==========================================================================
    # CITRUS CROPS
    # ==========================================================================
    citrus_crops = [
        # Oranges
        {
            'name': 'Navel Orange',
            'variety': 'Washington',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 22,
            'typical_spacing_tree_ft': 18,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 4,
            'productive_lifespan_years': 50,
            'kc_mature': 0.65,
            'kc_young': 0.45,
            'typical_harvest_months': 'Nov-May',
            'default_bin_weight_lbs': 900,
        },
        {
            'name': 'Navel Orange',
            'variety': 'Cara Cara',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 22,
            'typical_spacing_tree_ft': 18,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 4,
            'productive_lifespan_years': 50,
            'kc_mature': 0.65,
            'typical_harvest_months': 'Dec-Apr',
            'default_bin_weight_lbs': 900,
        },
        {
            'name': 'Valencia Orange',
            'variety': '',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 22,
            'typical_spacing_tree_ft': 18,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 4,
            'productive_lifespan_years': 50,
            'kc_mature': 0.65,
            'typical_harvest_months': 'Mar-Oct',
            'default_bin_weight_lbs': 900,
        },
        {
            'name': 'Blood Orange',
            'variety': 'Moro',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 20,
            'typical_spacing_tree_ft': 16,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 4,
            'kc_mature': 0.65,
            'typical_harvest_months': 'Dec-Mar',
            'default_bin_weight_lbs': 900,
        },
        # Lemons
        {
            'name': 'Eureka Lemon',
            'variety': '',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 20,
            'typical_spacing_tree_ft': 16,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 3,
            'productive_lifespan_years': 50,
            'kc_mature': 0.65,
            'typical_harvest_months': 'Year-round',
            'default_bin_weight_lbs': 900,
        },
        {
            'name': 'Lisbon Lemon',
            'variety': '',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 20,
            'typical_spacing_tree_ft': 16,
            'typical_root_depth_inches': 36,
            'years_to_maturity': 3,
            'productive_lifespan_years': 50,
            'kc_mature': 0.65,
            'typical_harvest_months': 'Year-round',
            'default_bin_weight_lbs': 900,
        },
        {
            'name': 'Meyer Lemon',
            'variety': 'Improved',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 18,
            'typical_spacing_tree_ft': 14,
            'typical_root_depth_inches': 30,
            'years_to_maturity': 2,
            'kc_mature': 0.60,
            'typical_harvest_months': 'Nov-Mar',
            'default_bin_weight_lbs': 800,
        },
        # Limes
        {
            'name': 'Persian Lime',
            'variety': 'Bearss',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 18,
            'typical_spacing_tree_ft': 15,
            'typical_root_depth_inches': 30,
            'years_to_maturity': 3,
            'kc_mature': 0.65,
            'typical_harvest_months': 'May-Sep',
            'default_bin_weight_lbs': 800,
        },
        # Grapefruit
        {
            'name': 'Grapefruit',
            'variety': 'Marsh',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 24,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 42,
            'years_to_maturity': 4,
            'productive_lifespan_years': 50,
            'kc_mature': 0.70,
            'typical_harvest_months': 'Nov-Jun',
            'default_bin_weight_lbs': 950,
        },
        {
            'name': 'Grapefruit',
            'variety': 'Star Ruby',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 24,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 42,
            'years_to_maturity': 4,
            'kc_mature': 0.70,
            'typical_harvest_months': 'Nov-May',
            'default_bin_weight_lbs': 950,
        },
        {
            'name': 'Oro Blanco',
            'variety': '',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 22,
            'typical_spacing_tree_ft': 18,
            'typical_root_depth_inches': 40,
            'years_to_maturity': 4,
            'kc_mature': 0.68,
            'typical_harvest_months': 'Nov-Feb',
            'default_bin_weight_lbs': 900,
        },
        # Mandarins/Tangerines
        {
            'name': 'Clementine',
            'variety': '',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 18,
            'typical_spacing_tree_ft': 14,
            'typical_root_depth_inches': 30,
            'years_to_maturity': 3,
            'kc_mature': 0.60,
            'typical_harvest_months': 'Nov-Jan',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Mandarin',
            'variety': 'W. Murcott (Afourer)',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 18,
            'typical_spacing_tree_ft': 12,
            'typical_root_depth_inches': 30,
            'years_to_maturity': 3,
            'kc_mature': 0.60,
            'typical_harvest_months': 'Feb-Apr',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Mandarin',
            'variety': 'Tango',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 18,
            'typical_spacing_tree_ft': 12,
            'typical_root_depth_inches': 30,
            'years_to_maturity': 3,
            'kc_mature': 0.60,
            'typical_harvest_months': 'Jan-Apr',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Mandarin',
            'variety': 'Satsuma',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 16,
            'typical_spacing_tree_ft': 12,
            'typical_root_depth_inches': 28,
            'years_to_maturity': 2,
            'kc_mature': 0.58,
            'typical_harvest_months': 'Oct-Dec',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Mandarin',
            'variety': 'Pixie',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 16,
            'typical_spacing_tree_ft': 10,
            'typical_root_depth_inches': 28,
            'years_to_maturity': 3,
            'kc_mature': 0.58,
            'typical_harvest_months': 'Mar-May',
            'default_bin_weight_lbs': 750,
        },
        {
            'name': 'Mandarin',
            'variety': 'Gold Nugget',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 16,
            'typical_spacing_tree_ft': 12,
            'typical_root_depth_inches': 28,
            'years_to_maturity': 3,
            'kc_mature': 0.58,
            'typical_harvest_months': 'Mar-May',
            'default_bin_weight_lbs': 800,
        },
        # Specialty citrus
        {
            'name': 'Kumquat',
            'variety': 'Nagami',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 12,
            'typical_spacing_tree_ft': 8,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 2,
            'kc_mature': 0.55,
            'typical_harvest_months': 'Nov-Mar',
            'default_bin_weight_lbs': 600,
        },
        {
            'name': 'Pummelo',
            'variety': 'Chandler',
            'category': 'citrus',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 24,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 42,
            'years_to_maturity': 4,
            'kc_mature': 0.70,
            'typical_harvest_months': 'Nov-Feb',
            'default_bin_weight_lbs': 950,
        },
    ]

    # ==========================================================================
    # AVOCADO CROPS
    # ==========================================================================
    avocado_crops = [
        {
            'name': 'Hass Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 25,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 5,
            'productive_lifespan_years': 40,
            'kc_mature': 0.70,
            'kc_young': 0.50,
            'typical_harvest_months': 'Feb-Sep',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Lamb Hass Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 25,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 5,
            'productive_lifespan_years': 40,
            'kc_mature': 0.70,
            'typical_harvest_months': 'May-Nov',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Fuerte Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 28,
            'typical_spacing_tree_ft': 22,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 4,
            'productive_lifespan_years': 40,
            'kc_mature': 0.72,
            'typical_harvest_months': 'Nov-Jun',
            'default_bin_weight_lbs': 850,
        },
        {
            'name': 'Bacon Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 28,
            'typical_spacing_tree_ft': 22,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 4,
            'kc_mature': 0.72,
            'typical_harvest_months': 'Nov-Mar',
            'default_bin_weight_lbs': 850,
        },
        {
            'name': 'Zutano Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 28,
            'typical_spacing_tree_ft': 22,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 4,
            'kc_mature': 0.72,
            'typical_harvest_months': 'Sep-Jan',
            'default_bin_weight_lbs': 850,
        },
        {
            'name': 'Pinkerton Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 22,
            'typical_spacing_tree_ft': 18,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 4,
            'kc_mature': 0.68,
            'typical_harvest_months': 'Nov-Apr',
            'default_bin_weight_lbs': 800,
        },
        {
            'name': 'Reed Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 25,
            'typical_spacing_tree_ft': 20,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 5,
            'kc_mature': 0.70,
            'typical_harvest_months': 'Jun-Oct',
            'default_bin_weight_lbs': 850,
        },
        {
            'name': 'GEM Avocado',
            'variety': '',
            'category': 'subtropical',
            'crop_type': 'tree',
            'typical_spacing_row_ft': 20,
            'typical_spacing_tree_ft': 15,
            'typical_root_depth_inches': 24,
            'years_to_maturity': 4,
            'kc_mature': 0.68,
            'typical_harvest_months': 'Apr-Sep',
            'default_bin_weight_lbs': 800,
        },
    ]

    # Create all crops
    crop_objects = {}
    for crop_data in citrus_crops + avocado_crops:
        crop = Crop.objects.create(
            company=None,  # System default
            active=True,
            **crop_data
        )
        # Store for rootstock linking
        key = f"{crop_data['name']}_{crop_data.get('variety', '')}"
        crop_objects[key] = crop

    # ==========================================================================
    # CITRUS ROOTSTOCKS
    # ==========================================================================
    citrus_rootstocks = [
        {
            'name': 'Carrizo Citrange',
            'code': 'Carrizo',
            'primary_category': 'citrus',
            'vigor': 'standard',
            'disease_resistance': 'CTV tolerant, Phytophthora tolerant, good for most soils',
            'soil_tolerance': 'Well-drained soils, moderate salinity tolerance',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'C-35 Citrange',
            'code': 'C-35',
            'primary_category': 'citrus',
            'vigor': 'semi_dwarf',
            'disease_resistance': 'CTV tolerant, Phytophthora tolerant',
            'soil_tolerance': 'Well-drained soils, good for high-density planting',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Swingle Citrumelo',
            'code': 'Swingle',
            'primary_category': 'citrus',
            'vigor': 'standard',
            'disease_resistance': 'CTV tolerant, excellent Phytophthora resistance, nematode tolerant',
            'soil_tolerance': 'Tolerates wet soils, low salinity tolerance',
            'cold_hardiness': 'Good',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Volkameriana',
            'code': 'Volk',
            'primary_category': 'citrus',
            'vigor': 'vigorous',
            'disease_resistance': 'CTV sensitive, good Phytophthora tolerance',
            'soil_tolerance': 'Excellent for poor soils, good drought tolerance',
            'cold_hardiness': 'Poor',
            'drought_tolerance': 'high',
        },
        {
            'name': 'Rough Lemon',
            'code': 'RL',
            'primary_category': 'citrus',
            'vigor': 'vigorous',
            'disease_resistance': 'CTV tolerant, susceptible to Phytophthora',
            'soil_tolerance': 'Sandy soils, good drought tolerance',
            'cold_hardiness': 'Poor',
            'drought_tolerance': 'high',
        },
        {
            'name': 'Troyer Citrange',
            'code': 'Troyer',
            'primary_category': 'citrus',
            'vigor': 'standard',
            'disease_resistance': 'CTV tolerant, moderate Phytophthora tolerance',
            'soil_tolerance': 'Well-drained soils',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Trifoliate Orange',
            'code': 'P. trifoliata',
            'primary_category': 'citrus',
            'vigor': 'dwarf',
            'disease_resistance': 'CTV tolerant, excellent Phytophthora resistance',
            'soil_tolerance': 'Sensitive to calcareous soils, needs good drainage',
            'cold_hardiness': 'Excellent',
            'drought_tolerance': 'low',
        },
        {
            'name': 'US-812',
            'code': 'US-812',
            'primary_category': 'citrus',
            'vigor': 'semi_dwarf',
            'disease_resistance': 'CTV tolerant, good Phytophthora resistance, HLB tolerant',
            'soil_tolerance': 'Wide soil adaptability',
            'cold_hardiness': 'Good',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'US-897',
            'code': 'US-897',
            'primary_category': 'citrus',
            'vigor': 'semi_dwarf',
            'disease_resistance': 'CTV tolerant, good Phytophthora resistance',
            'soil_tolerance': 'Good for replant situations',
            'cold_hardiness': 'Good',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'X639',
            'code': 'X639',
            'primary_category': 'citrus',
            'vigor': 'standard',
            'disease_resistance': 'CTV tolerant, moderate Phytophthora tolerance',
            'soil_tolerance': 'Well-drained soils, moderate salinity tolerance',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Macrophylla',
            'code': 'Macro',
            'primary_category': 'citrus',
            'vigor': 'vigorous',
            'disease_resistance': 'CTV tolerant for lemons, susceptible to Phytophthora',
            'soil_tolerance': 'Coastal areas, moderate salinity tolerance',
            'cold_hardiness': 'Poor',
            'drought_tolerance': 'low',
        },
    ]

    # ==========================================================================
    # AVOCADO ROOTSTOCKS
    # ==========================================================================
    avocado_rootstocks = [
        {
            'name': 'Dusa',
            'code': 'Dusa',
            'primary_category': 'subtropical',
            'vigor': 'standard',
            'disease_resistance': 'Excellent Phytophthora root rot resistance',
            'soil_tolerance': 'Wide adaptability, good for replant situations',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Clonal Duke 7',
            'code': 'Duke 7',
            'primary_category': 'subtropical',
            'vigor': 'vigorous',
            'disease_resistance': 'Good Phytophthora tolerance',
            'soil_tolerance': 'Most soil types, good drainage required',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Toro Canyon',
            'code': 'TC',
            'primary_category': 'subtropical',
            'vigor': 'standard',
            'disease_resistance': 'Moderate Phytophthora tolerance',
            'soil_tolerance': 'Well-drained soils',
            'cold_hardiness': 'Good',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Zutano Seedling',
            'code': 'Zut',
            'primary_category': 'subtropical',
            'vigor': 'vigorous',
            'disease_resistance': 'Low Phytophthora tolerance',
            'soil_tolerance': 'Good drainage required',
            'cold_hardiness': 'Good',
            'drought_tolerance': 'low',
        },
        {
            'name': 'Mexicola Seedling',
            'code': 'Mex',
            'primary_category': 'subtropical',
            'vigor': 'vigorous',
            'disease_resistance': 'Low Phytophthora tolerance, cold hardy',
            'soil_tolerance': 'Adaptable, prefers well-drained',
            'cold_hardiness': 'Excellent',
            'drought_tolerance': 'low',
        },
        {
            'name': 'Steddom',
            'code': 'Steddom',
            'primary_category': 'subtropical',
            'vigor': 'standard',
            'disease_resistance': 'Good Phytophthora resistance',
            'soil_tolerance': 'Wide soil adaptability',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Bounty',
            'code': 'Bounty',
            'primary_category': 'subtropical',
            'vigor': 'semi_dwarf',
            'disease_resistance': 'Good Phytophthora resistance',
            'soil_tolerance': 'Adaptable, good for high-density',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
        {
            'name': 'Zentmyer',
            'code': 'Zent',
            'primary_category': 'subtropical',
            'vigor': 'standard',
            'disease_resistance': 'Excellent Phytophthora resistance',
            'soil_tolerance': 'Good for heavy soils',
            'cold_hardiness': 'Moderate',
            'drought_tolerance': 'moderate',
        },
    ]

    # Create rootstocks
    for rs_data in citrus_rootstocks + avocado_rootstocks:
        Rootstock.objects.create(
            company=None,  # System default
            active=True,
            **rs_data
        )


def reverse_seed(apps, schema_editor):
    """Remove seeded data."""
    Crop = apps.get_model('api', 'Crop')
    Rootstock = apps.get_model('api', 'Rootstock')

    # Only delete system defaults (company=null)
    Crop.objects.filter(company__isnull=True).delete()
    Rootstock.objects.filter(company__isnull=True).delete()


class Migration(migrations.Migration):

    dependencies = [
        ('api', '0013_crop_rootstock_field_enhancements'),
    ]

    operations = [
        migrations.RunPython(seed_crops_and_rootstocks, reverse_seed),
    ]
